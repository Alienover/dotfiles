#!/usr/bin/env nix-shell
#! nix-shell -i sh -p stow

DOT_DIR="$(dirname $(readlink -f "$0"))/dotfiles"

dotfiles=(
  nvim
  tmux
  shell
  user_scripts
  tmuxifier
  nixpkgs
  git
)

. ./setup "${dotfiles[@]}"

# Install Nix packages from config.nix
nix-env -iA nixpkgs.devPackages

SHELL_PROFILE="${HOME}/.profile"
if [ -f "$SHELL_PROFILE" ]; then
  extra=(
    "[ -f '${HOME}/.config/shell/profile.default' ] && . ${HOME}/.config/shell/profile.default"
  )

  for line in "${extra[@]}"; do
    if ! grep -qxF "$line" "$SHELL_PROFILE" 2>/dev/null; then
      printf "$line\n" >> "$SHELL_PROFILE"
    fi
  done
fi
