#!/usr/bin/env nix-shell
#! nix-shell -i sh -p stow

DOT_DIR="$(dirname $(readlink -f "$0"))/dotfiles"

dotfiles=(
  nvim
  tmux
  zsh
  shell
  user_scripts
  tmuxifier
  gnupg
  ssh
  nixpkgs
)

cd $DOT_DIR > /dev/null

for file in "${dotfiles[@]}"; do
  echo -e "Stowing $file ..."
  stow $file --no-folding
done

cd - > /dev/null

echo -e "Stow Done!"

# Install Nix packages from config.nix
nix-env -iA nixpkgs.devPackages

# Switch the default shell to zsh
sudo chsh -s "$(which zsh)" "$(whoami)"

# Install the nvim dependencies
if command -v nvim>/dev/null 2&1; then
  nvim --headless "+Lazy! restore" +qa
fi
